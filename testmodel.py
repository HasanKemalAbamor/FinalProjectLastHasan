import joblib
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# Load the trained model
model_path = 'trained72'  # Update this path to your actual model path
model = joblib.load(model_path)


# Function to preprocess the data
def preprocess_data(data):
	# Ensure all required columns are present
	required_columns = ['absorbance' + str(i) for i in range(170)] + ['temperature', 'humidity']
	for col in required_columns:
		if col not in data.columns:
			data[col] = 0  # Add missing columns with default value 0

	return data[required_columns]


# Function to make predictions
def make_predictions(model, data):
	preprocessed_data = preprocess_data(data)
	predictions = model.predict(preprocessed_data)
	return predictions


# Sample data for testing
sample_data_1 = {
	'Reading_ID': ['ID_MVJGPQ75'],
	'absorbance0': [0.44499804311848],
	'absorbance1': [0.45803393294506],
	'absorbance2': [0.44738639432465],
	'absorbance3': [0.45692076507684],
	'absorbance4': [0.46322505958276],
	'absorbance5': [0.47598313240859],
	'absorbance6': [0.47681711170555],
	'absorbance7': [0.48156478163636],
	'absorbance8': [0.49001019622943],
	'absorbance9': [0.50589197627773],
	'absorbance10': [0.51812480623424],
	'absorbance11': [0.53036181733835],
	'absorbance12': [0.53853015068971],
	'absorbance13': [0.54312812221511],
	'absorbance14': [0.54628745186356],
	'absorbance15': [0.54700088917358],
	'absorbance16': [0.54711976781823],
	'absorbance17': [0.54635127655011],
	'absorbance18': [0.54425376875636],
	'absorbance19': [0.54280243426973],
	'absorbance20': [0.54220744105554],
	'absorbance21': [0.5397793956215],
	'absorbance22': [0.53641701575494],
	'absorbance23': [0.53338001659229],
	'absorbance24': [0.53111744173577],
	'absorbance25': [0.52909254022042],
	'absorbance26': [0.52610057752043],
	'absorbance27': [0.52459881644867],
	'absorbance28': [0.52295161432237],
	'absorbance29': [0.52155070274581],
	'absorbance30': [0.52114857607308],
	'absorbance31': [0.52047847187661],
	'absorbance32': [0.52143200087764],
	'absorbance33': [0.52147309311389],
	'absorbance34': [0.52356675832519],
	'absorbance35': [0.52581577291535],
	'absorbance36': [0.52788911084863],
	'absorbance37': [0.53069702553115],
	'absorbance38': [0.53341609382412],
	'absorbance39': [0.54012401126989],
	'absorbance40': [0.54298041951161],
	'absorbance41': [0.54936339147011],
	'absorbance42': [0.55717442050237],
	'absorbance43': [0.56693494352487],
	'absorbance44': [0.58740992535407],
	'absorbance45': [0.61943594356717],
	'absorbance46': [0.6494918162586],
	'absorbance47': [0.68065203605786],
	'absorbance48': [0.70256923261465],
	'absorbance49': [0.71912352306183],
	'absorbance50': [0.72816895004858],
	'absorbance51': [0.73587814765883],
	'absorbance52': [0.74076746061761],
	'absorbance53': [0.74354727610857],
	'absorbance54': [0.74787886097023],
	'absorbance55': [0.74906821950209],
	'absorbance56': [0.75071210990248],
	'absorbance57': [0.74781810981298],
	'absorbance58': [0.74428060664023],
	'absorbance59': [0.7430950806794],
	'absorbance60': [0.73751816947911],
	'absorbance61': [0.73451514846768],
	'absorbance62': [0.73030908030377],
	'absorbance63': [0.72636756713292],
	'absorbance64': [0.72200635380114],
	'absorbance65': [0.71859255384971],
	'absorbance66': [0.7159032665836],
	'absorbance67': [0.71424201284803],
	'absorbance68': [0.7125301424274],
	'absorbance69': [0.7131571204822],
	'absorbance70': [0.71459322843027],
	'absorbance71': [0.71655706740159],
	'absorbance72': [0.71851075160852],
	'absorbance73': [0.72237931304783],
	'absorbance74': [0.72730865687635],
	'absorbance75': [0.73146462308894],
	'absorbance76': [0.74023614577174],
	'absorbance77': [0.74782706794804],
	'absorbance78': [0.75945943579615],
	'absorbance79': [0.77035921127786],
	'absorbance80': [0.78780360928955],
	'absorbance81': [0.80383102485842],
	'absorbance82': [0.8286371084297],
	'absorbance83': [0.8494506500451],
	'absorbance84': [0.87407984864857],
	'absorbance85': [0.90035989363185],
	'absorbance86': [0.92653461281299],
	'absorbance87': [0.95328541896526],
	'absorbance88': [0.98439448844839],
	'absorbance89': [1.0076802531922],
	'absorbance90': [1.0291491319286],
	'absorbance91': [1.0525895476957],
	'absorbance92': [1.0809172891802],
	'absorbance93': [1.1155887979017],
	'absorbance94': [1.1732878036227],
	'absorbance95': [1.2315738603967],
	'absorbance96': [1.3053354011862],
	'absorbance97': [1.387899377664],
	'absorbance98': [1.4629431214354],
	'absorbance99': [1.5359177410466],
	'absorbance100': [1.5815076397883],
	'absorbance101': [1.622933796452],
	'absorbance102': [1.6470288948134],
	'absorbance103': [1.6667048747063],
	'absorbance104': [1.6822101928717],
	'absorbance105': [1.6863753705333],
	'absorbance106': [1.6944600134065],
	'absorbance107': [1.6952309503917],
	'absorbance108': [1.7091224861562],
	'absorbance109': [1.7018750707378],
	'absorbance110': [1.7027887454405],
	'absorbance111': [1.7102442003744],
	'absorbance112': [1.717370126534],
	'absorbance113': [1.7152226087369],
	'absorbance114': [1.7038883812081],
	'absorbance115': [1.7038698702514],
	'absorbance116': [1.6998349459912],
	'absorbance117': [1.6856034610524],
	'absorbance118': [1.6999907079937],
	'absorbance119': [1.6755280255819],
	'absorbance120': [1.6717003145365],
	'absorbance121': [1.6671872916059],
	'absorbance122': [1.6643964398599],
	'absorbance123': [1.6503511157026],
	'absorbance124': [1.6461143829699],
	'absorbance125': [1.6386567638026],
	'absorbance126': [1.6265548440112],
	'absorbance127': [1.6100170297709],
	'absorbance128': [1.5968009592414],
	'absorbance129': [1.5853328580386],
	'absorbance130': [1.579273669293],
	'absorbance131': [1.5612091669633],
	'absorbance132': [1.5390596868814],
	'absorbance133': [1.5442115686454],
	'absorbance134': [1.52598902306],
	'absorbance135': [1.516723132325],
	'absorbance136': [1.502255323154],
	'absorbance137': [1.4891315134641],
	'absorbance138': [1.483307696436],
	'absorbance139': [1.4610279826243],
	'absorbance140': [1.4531735943557],
	'absorbance141': [1.4504117471132],
	'absorbance142': [1.4377839910421],
	'absorbance143': [1.4221480649728],
	'absorbance144': [1.4158801950627],
	'absorbance145': [1.4046979883332],
	'absorbance146': [1.3881430862161],
	'absorbance147': [1.3972413630096],
	'absorbance148': [1.3856798659938],
	'absorbance149': [1.3763547148966],
	'absorbance150': [1.357757651103],
	'absorbance151': [1.3548540678739],
	'absorbance152': [1.3454756310492],
	'absorbance153': [1.3338095872828],
	'absorbance154': [1.332739342629],
	'absorbance155': [1.3355496368252],
	'absorbance156': [1.3267752954475],
	'absorbance157': [1.3368619942964],
	'absorbance158': [1.3168595414553],
	'absorbance159': [1.328051473302],
	'absorbance160': [1.3286406543961],
	'absorbance161': [1.3235256234314],
	'absorbance162': [1.3141239320153],
	'absorbance163': [1.2989363921242],
	'absorbance164': [1.2891223309704],
	'absorbance165': [1.3250587777441],
	'absorbance166': [1.271114757976],
	'absorbance167': [1.3371185881303],
	'temperature': [45.77],
	'humidity': [24.8]
}

sample_data_2 = {
	'Reading_ID': ['ID_6F983ZLX'],
	'absorbance0': [0.63557359899311],
	'absorbance1': [0.63760309806731],
	'absorbance2': [0.63999200639643],
	'absorbance3': [0.64644114900016],
	'absorbance4': [0.65184925756821],
	'absorbance5': [0.65923549604343],
	'absorbance6': [0.66762216994423],
	'absorbance7': [0.67421283538097],
	'absorbance8': [0.68420119076194],
	'absorbance9': [0.69471204847198],
	'absorbance10': [0.71096842935402],
	'absorbance11': [0.72444973093143],
	'absorbance12': [0.73444169394906],
	'absorbance13': [0.73846579380642],
	'absorbance14': [0.74102314658189],
	'absorbance15': [0.74172836618002],
	'absorbance16': [0.73871774414665],
	'absorbance17': [0.73600596175995],
	'absorbance18': [0.73427431277221],
	'absorbance19': [0.7316924561722],
	'absorbance20': [0.72904448604424],
	'absorbance21': [0.72645157950785],
	'absorbance22': [0.72273597262878],
	'absorbance23': [0.71959066871199],
	'absorbance24': [0.71812399971685],
	'absorbance25': [0.7149064431957],
	'absorbance26': [0.71175871240533],
	'absorbance27': [0.71049306910911],
	'absorbance28': [0.70749840729325],
	'absorbance29': [0.70730927018688],
	'absorbance30': [0.70684636858571],
	'absorbance31': [0.70709224858401],
	'absorbance32': [0.7067961198823],
	'absorbance33': [0.70914190878451],
	'absorbance34': [0.70924237046193],
	'absorbance35': [0.71280778932771],
	'absorbance36': [0.71493365172725],
	'absorbance37': [0.71974769237702],
	'absorbance38': [0.72368593524937],
	'absorbance39': [0.72652184895763],
	'absorbance40': [0.73566098280865],
	'absorbance41': [0.73818775734784],
	'absorbance42': [0.74724102235271],
	'absorbance43': [0.75855159548826],
	'absorbance44': [0.7776808100224],
	'absorbance45': [0.80174407571326],
	'absorbance46': [0.83945391531148],
	'absorbance47': [0.86576452585379],
	'absorbance48': [0.88888764911137],
	'absorbance49': [0.90214761956005],
	'absorbance50': [0.91223440972861],
	'absorbance51': [0.91705746664371],
	'absorbance52': [0.92362996273776],
	'absorbance53': [0.93121016807178],
	'absorbance54': [0.93311779322389],
	'absorbance55': [0.9387159305261],
	'absorbance56': [0.93884440700968],
	'absorbance57': [0.93777826246753],
	'absorbance58': [0.9365793903661],
	'absorbance59': [0.93319776739491],
	'absorbance60': [0.92902699299154],
	'absorbance61': [0.9285994116495],
	'absorbance62': [0.92510502369074],
	'absorbance63': [0.91838655703419],
	'absorbance64': [0.91596539285543],
	'absorbance65': [0.91181953316968],
	'absorbance66': [0.90997170837648],
	'absorbance67': [0.90669021092492],
	'absorbance68': [0.90686934012697],
	'absorbance69': [0.90665236651866],
	'absorbance70': [0.90704458364116],
	'absorbance71': [0.90857241590228],
	'absorbance72': [0.91007689411568],
	'absorbance73': [0.91472244399718],
	'absorbance74': [0.91824163803893],
	'absorbance75': [0.92357423523866],
	'absorbance76': [0.93021230103861],
	'absorbance77': [0.93787438452738],
	'absorbance78': [0.94572209426213],
	'absorbance79': [0.95582510967744],
	'absorbance80': [0.97002723698496],
	'absorbance81': [0.98804076344675],
	'absorbance82': [1.0051255351882],
	'absorbance83': [1.0236284846628],
	'absorbance84': [1.0452712430541],
	'absorbance85': [1.068400622903],
	'absorbance86': [1.0892793117678],
	'absorbance87': [1.1169685331853],
	'absorbance88': [1.1370744091144],
	'absorbance89': [1.1551297186931],
	'absorbance90': [1.1773495640697],
	'absorbance91': [1.1939496320017],
	'absorbance92': [1.2188168567615],
	'absorbance93': [1.2505599439743],
	'absorbance94': [1.2873825972194],
	'absorbance95': [1.3337651249836],
	'absorbance96': [1.3872941313205],
	'absorbance97': [1.4489990470503],
	'absorbance98': [1.5314872356647],
	'absorbance99': [1.5808044595164],
	'absorbance100': [1.6245021676632],
	'absorbance101': [1.6411396049817],
	'absorbance102': [1.6798873036798],
	'absorbance103': [1.6906408539291],
	'absorbance104': [1.6991571285847],
	'absorbance105': [1.7114235807932],
	'absorbance106': [1.7189529938001],
	'absorbance107': [1.7226924061993],
	'absorbance108': [1.7263405440487],
	'absorbance109': [1.7365065667329],
	'absorbance110': [1.7304598674434],
	'absorbance111': [1.7321551097148],
	'absorbance112': [1.730653117782],
	'absorbance113': [1.7368727678179],
	'absorbance114': [1.7297077006178],
	'absorbance115': [1.7278613740762],
	'absorbance116': [1.7103212675456],
	'absorbance117': [1.7212501047286],
	'absorbance118': [1.7073384926121],
	'absorbance119': [1.7135574823536],
	'absorbance120': [1.7196064362607],
	'absorbance121': [1.6902006312128],
	'absorbance122': [1.6911109220065],
	'absorbance123': [1.6889607381865],
	'absorbance124': [1.6764314989887],
	'absorbance125': [1.664768749105],
	'absorbance126': [1.661799456983],
	'absorbance127': [1.6436308482926],
	'absorbance128': [1.6418240860131],
	'absorbance129': [1.6332608039921],
	'absorbance130': [1.6285396298199],
	'absorbance131': [1.5991340674656],
	'absorbance132': [1.5994538443102],
	'absorbance133': [1.5889960695243],
	'absorbance134': [1.5789686455502],
	'absorbance135': [1.5721252543534],
	'absorbance136': [1.556968941407],
	'absorbance137': [1.5609355235935],
	'absorbance138': [1.5569872143472],
	'absorbance139': [1.539212412721],
	'absorbance140': [1.5309538518649],
	'absorbance141': [1.5189755690139],
	'absorbance142': [1.5186909592376],
	'absorbance143': [1.5063869107005],
	'absorbance144': [1.5044111905647],
	'absorbance145': [1.4874513684439],
	'absorbance146': [1.4779929216839],
	'absorbance147': [1.4773768667554],
	'absorbance148': [1.4626877128326],
	'absorbance149': [1.4604613414816],
	'absorbance150': [1.457779400935],
	'absorbance151': [1.4466718742174],
	'absorbance152': [1.4339837276243],
	'absorbance153': [1.4335691750049],
	'absorbance154': [1.4386491427502],
	'absorbance155': [1.429754576084],
	'absorbance156': [1.4225975461812],
	'absorbance157': [1.4382466507341],
	'absorbance158': [1.4253497064033],
	'absorbance159': [1.4163516242209],
	'absorbance160': [1.4290363193679],
	'absorbance161': [1.4118655260101],
	'absorbance162': [1.417538615081],
	'absorbance163': [1.4437350083575],
	'absorbance164': [1.4525662773226],
	'absorbance165': [1.4467421019982],
	'absorbance166': [1.4276501295427],
	'absorbance167': [1.4492173661128],
	'temperature': [45.11],
	'humidity': [23.66]
}

# Convert sample data to DataFrame
df_1 = pd.DataFrame(sample_data_1)
df_2 = pd.DataFrame(sample_data_2)

# Make predictions
predictions_1 = make_predictions(model, df_1)
predictions_2 = make_predictions(model, df_2)

print("Predictions for ID_MVJGPQ75:", predictions_1)
print("Predictions for ID_6F983ZLX:", predictions_2)

# Plot absorbance values for the first sample
plt.figure(figsize=(12, 6))
plt.plot(range(168), df_1.iloc[0, 1:169].values, label='ID_MVJGPQ75', marker='o')
plt.xlabel('Absorbance Index')
plt.ylabel('Absorbance Value')
plt.title('Absorbance Values for ID_MVJGPQ75')
plt.legend()
plt.show()

# Plot absorbance values for the second sample
plt.figure(figsize=(12, 6))
plt.plot(range(168), df_2.iloc[0, 1:169].values, label='ID_6F983ZLX', marker='o')
plt.xlabel('Absorbance Index')
plt.ylabel('Absorbance Value')
plt.title('Absorbance Values for ID_6F983ZLX')
plt.legend()
plt.show()
